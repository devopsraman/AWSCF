
## Description

Rackspace Hosting - AutoRecovery EC2 Instance. **WARNING** You will be billed for the AWS resources used if you create a stack from this template.

#### Metadata

 * **AWS::CloudFormation::Interface**: {u'ParameterGroups': [{u'Parameters': [u'VPCID', u'AppSubnet', u'ELBSubnet'], u'Label': {u'default': u'Network Configuration'}}, {u'Parameters': [u'ELBCreation', u'ELBInstancePort', u'ELBInstanceProtocol', u'ELBLoadBalancerPort', u'ELBLoadBalancerProtocol', u'ELBSecondaryListener', u'ELB2ndInstancePort', u'ELB2ndInstanceProtocol', u'ELB2ndLoadBalancerPort', u'ELB2ndLoadBalancerProtocol', u'ELBHealthTarget', u'ELBHealthyThreshold', u'ELBUnHealthyThreshold', u'ELBHealthInterval', u'ELBHealthTimeout', u'ELBScheme', u'ELBCookieExpirationPeriod'], u'Label': {u'default': u'ELB Configuration'}}, {u'Parameters': [u'SSLIdCert'], u'Label': {u'default': u'ELB SSL Configuration'}}, {u'Parameters': [u'InstancesPublicIP', u'ARInstanceName', u'Environment', u'DetailedMonitoring', u'EBSOptimized', u'InstanceType', u'EbsVolumeSize', u'Iops', u'EbsVolumeType', u'EncryptEBSVolume', u'CreationPolicyTimeOut'], u'Label': {u'default': u'EC2 Instances Configuration'}}, {u'Parameters': [u'ELBLatency'], u'Label': {u'default': u'CloudWatch ELB Alarm Configuration'}}]}
 * **Comments**: Generated by Ansible
 * **Version**: v1.1

## Parameters

 * **ARInstanceName** - EC2 Server Instance Name
  * Constraint: `Must follow normal syntax conventions.`
 * **ARInstanceSecurityGroupList** - A list that contains the EC2 security groups to assign to the Amazon EC2 instance
 * **AppSubnet** - Subnets for Application
 * **CreationPolicyTimeOut** - Time to wait for the number of signals for the creation policy. H/M/S Hours/Minutes/Seconds
  * Default: `20M`
  * Constraint: `#H#M#S where each # is the number of hours or minutes or seconds`
 * **CwCpuHighEvaluations** - The number of periods over which data is compared to the specified threshold.
  * Default: `2`
  * Constraint: `Must be a valid integer.`
 * **CwCpuHighOperator** - Math operator used by CloudWatch for alarms and triggers.
  * Default: `GreaterThanThreshold`
 * **CwCpuHighPeriod** - Time the specified statistic is applied. Must be in seconds that is also a multiple of 60.
  * Default: `300`
  * Constraint: `Must be a valid integer.`
 * **CwCpuHighThreshold** - The value against which the specified statistic is compared.
  * Default: `90`
  * Constraint: `Must be a valid integer.`
 * **CwCpuLowEvaluations** - The number of periods over which data is compared to the specified threshold.
  * Default: `2`
  * Constraint: `Must be a valid integer.`
 * **CwCpuLowOperator** - Math operator used by CloudWatch for alarms and triggers.
  * Default: `LessThanThreshold`
 * **CwCpuLowPeriod** - Time the specified statistic is applied. Must be in seconds that is also a multiple of 60.
  * Default: `300`
  * Constraint: `Must be a valid integer.`
 * **CwCpuLowThreshold** - The value against which the specified statistic is compared.
  * Default: `50`
  * Constraint: `Must be a valid integer.`
 * **DetailedMonitoring** - Enable Detailed Monitoring.
  * Default: `True`
 * **EBSOptimized** - Use EBS Optimized.
  * Default: `False`
 * **EIP** - Specifies whether to launch instance with EIP address in your VPC.
  * Default: `False`
 * **ELB2ndInstancePort** - Specifies the 2nd TCP port on which the instance server is listening.
  * Default: `443`
  * Constraint: `Must be a valid integer.`
 * **ELB2ndInstanceProtocol** - Specifies the 2nd protocol to use for routing traffic to back-end instances HTTP / HTTPS / TCP / SSL.
  * Default: `HTTPS`
 * **ELB2ndLoadBalancerPort** - Specifies the 2nd external load balancer port number.
  * Default: `443`
  * Constraint: `Must be a valid integer.`
 * **ELB2ndLoadBalancerProtocol** - Specifies the 2nd protocol to use for the Load Balancer HTTP / HTTPS / TCP / SSL.
  * Default: `HTTPS`
 * **ELBConnectionDrainingTimeout** - Set the timeout value for elastic loadbalancer draining policy if desired. OPTIONAL
  * Default: `0`
 * **ELBCookieExpirationPeriod** - Generates a stickiness policy with sticky session lifetimes controlled by a specified expiration period. Leave blank not to use.
  * Default: ``
 * **ELBCreation** - Specifies whether to create an ELB or not as part of this deployment.
  * Default: `True`
 * **ELBHealthInterval** - Seconds between health checks.
  * Default: `30`
  * Constraint: `Must be a valid integer.`
 * **ELBHealthTarget** - Protocol & port check on instance. TCP:5000 | SSL:5000 || HTTP(S) = HTTP:80/path/to/my/file.
  * Default: `TCP:80`
 * **ELBHealthTimeout** - Number of seconds during which no response means a failed health probe.
  * Default: `5`
  * Constraint: `Must be a valid integer.`
 * **ELBHealthyThreshold** - Consecutive successful checks before marking instance healthy.
  * Default: `3`
  * Constraint: `Must be a valid integer.`
 * **ELBInstancePort** - Specifies the TCP port on which the instance server is listening.
  * Default: `80`
  * Constraint: `Must be a valid integer.`
 * **ELBInstanceProtocol** - Specifies the protocol to use for routing traffic to back-end instances HTTP / HTTPS / TCP / SSL.
  * Default: `HTTP`
 * **ELBLatency** - ELB Latency threshold used by CloudWatch for ELBLatency alarm
  * Default: `5`
  * Constraint: `Must be a valid integer.`
 * **ELBLoadBalancerPort** - Specifies the external load balancer port number.
  * Default: `80`
  * Constraint: `Must be a valid integer.`
 * **ELBLoadBalancerProtocol** - Specifies the protocol to use for the Load Balancer HTTP / HTTPS / TCP / SSL.
  * Default: `HTTP`
 * **ELBLogAccessControl** - Define ACL for Bucket
  * Default: `BucketOwnerFullControl`
  * Constraint: `Must be either AuthenticatedRead, AwsExecRead, BucketOwnerRead, BucketOwnerFullControl, LogDeliveryWrite, Private, PublicRead or PublicReadWrite.`
 * **ELBLogBucketName** - The name of the bucket to use for ELB logs. Must be unique.
  * Default: ``
  * Constraint: `The bucket name must contain only lowercase letters, numbers, periods (.), and dashes (-).`
 * **ELBScheme** - Specifies whether to create an internal ELB or a public facing one.
  * Default: `internet-facing`
 * **ELBSecondaryListener** - Enable Secondary Listener on the Load Balancer
  * Default: `False`
 * **ELBSecurityGroupList** - A list of security groups assigned to your load balancer within your virtual private cloud (VPC).
 * **ELBSubnet** - Subnets for Elastic Loadbalancer ** REQUIRED even if ELBCreation is False **
 * **ELBUnHealthyThreshold** - Consecutive failed checks before marking instance unhealthy.
  * Default: `5`
  * Constraint: `Must be a valid integer.`
 * **EbsVolumeSize** - Select EBS Volume Size in GB.
  * Default: `60`
 * **EbsVolumeType** - Select EBS Volume Type.
  * Default: `gp2`
 * **Environment** - Application environment for which this network is being created. e.g. Development/Production.
  * Default: `Development`
 * **ImageId** - The image ID to be used to build the EC2 Instance. OPTIONAL
  * Default: ``
 * **InstanceType** - Select instance type
  * Default: `t2.micro`
  * Constraint: `Must be a valid EC2 instance type. Default is t2.micro`
 * **Iops** - Iops value required for use with io1 EBS volumes. This value should be 3 times the EBS volume size
  * Default: `0`
 * **KeyName** - Name of an existing EC2 KeyPair to enable SSH access to the instances.
  * Constraint: `Must be the name of an existing EC2 KeyPair.`
 * **NotificationEmail** - EMail address for notifications operations. OPTIONAL
  * Default: `noemail@email.com`
  * Constraint: `Must be a valid email address.`
 * **SSLIdCert** - SSL Certificate Name. Full ARN required.
  * Default: `0`
  * Constraint: `Must be an existing SSL Name.`
 * **VPCID** - Select Virtual Private Cloud ID

## Conditions

 * **DetailedMonitoring** - `{u'Fn::Equals': [{u'Ref': u'DetailedMonitoring'}, u'True']}`
 * **ELBCookieStickinessPolicy** - `{u'Fn::Not': [{u'Fn::Equals': [{u'Ref': u'ELBCookieExpirationPeriod'}, u'']}]}`
 * **ELBEnabled** - `{u'Fn::Equals': [{u'Ref': u'ELBCreation'}, u'True']}`
 * **IopsEnabled** - `{u'Fn::Equals': [{u'Ref': u'EbsVolumeType'}, u'io1']}`
 * **SSL2ndEnabled** - `{u'Fn::Or': [{u'Fn::Equals': [{u'Ref': u'ELB2ndLoadBalancerProtocol'}, u'SSL']}, {u'Fn::Equals': [{u'Ref': u'ELB2ndLoadBalancerProtocol'}, u'HTTPS']}]}`
 * **SSLEnabled** - `{u'Fn::Or': [{u'Fn::Equals': [{u'Ref': u'ELBLoadBalancerProtocol'}, u'SSL']}, {u'Fn::Equals': [{u'Ref': u'ELBLoadBalancerProtocol'}, u'HTTPS']}]}`
 * **isEIP** - `{u'Fn::Equals': [{u'Ref': u'EIP'}, u'True']}`
 * **isELB2ndListener** - `{u'Fn::Equals': [{u'Ref': u'ELBSecondaryListener'}, u'True']}`
 * **isELBConnectionDrain** - `{u'Fn::Not': [{u'Fn::Equals': [{u'Ref': u'ELBConnectionDrainingTimeout'}, u'0']}]}`
 * **isELBLogging** - `{u'Fn::Not': [{u'Fn::Equals': [{u'Ref': u'ELBLogBucketName'}, u'']}]}`
 * **isImageId** - `{u'Fn::Not': [{u'Fn::Equals': [{u'Ref': u'ImageId'}, u'']}]}`
 * **isNotification** - `{u'Fn::Not': [{u'Fn::Equals': [{u'Ref': u'NotificationEmail'}, u'noemail@email.com']}]}`

## Mappings

 * **AWSRegionArch2AMI**:
  * `(u'ap-south-1', {u'64': u'ami-9b1c76f4'})`
  * `(u'us-east-1', {u'64': u'ami-1c221e76'})`
  * `(u'ap-northeast-1', {u'64': u'ami-fa3d3f94'})`
  * `(u'ap-southeast-2', {u'64': u'ami-87d2f4e4'})`
  * `(u'eu-west-1', {u'64': u'ami-edb9069e'})`
  * `(u'ap-southeast-1', {u'64': u'ami-106aa373'})`
  * `(u'ap-northeast-2', {u'64': u'ami-56478938'})`
  * `(u'us-west-2', {u'64': u'ami-05cf2265'})`
  * `(u'us-west-1', {u'64': u'ami-ac5f2fcc'})`
  * `(u'eu-central-1', {u'64': u'ami-2bf11444'})`
  * `(u'sa-east-1', {u'64': u'ami-03b93b6f'})`

## Resources

 * **ARInstance** - `AWS::EC2::Instance`
 * **CPUAlarmHigh** - `AWS::CloudWatch::Alarm`
 * **CloudFormationLogs** - `AWS::Logs::LogGroup`
 * **EIPAR** - `AWS::EC2::EIP`
 * **ELBLatencyAlarm** - `AWS::CloudWatch::Alarm`
 * **ELBS3LoggingBucketPolicy** - `AWS::S3::BucketPolicy`
 * **ElasticLoadBalancer** - `AWS::ElasticLoadBalancing::LoadBalancer`
 * **InstanceRole** - `AWS::IAM::Role`
 * **InstanceRoleInstanceProfile** - `AWS::IAM::InstanceProfile`
 * **InstanceRolePolicies** - `AWS::IAM::Policy`
 * **NotificationTopic** - `AWS::SNS::Topic`
 * **S3BucketwithLogging** - `AWS::S3::Bucket`
 * **StatusCheckFailedInstanceAlarmReboot** - `AWS::CloudWatch::Alarm`
 * **StatusCheckFailedInstanceAlarmTicket** - `AWS::CloudWatch::Alarm`
 * **StatusCheckFailedSystemAlarmRecover** - `AWS::CloudWatch::Alarm`
 * **StatusCheckFailedSystemAlarmTicket** - `AWS::CloudWatch::Alarm`

## Outputs

 * **EIP** - `{u'Ref': u'EIPAR'}`
 * **URL** - `{u'Fn::Join': [u'', [u'http://', {u'Fn::GetAtt': [u'ElasticLoadBalancer', u'DNSName']}]]}`