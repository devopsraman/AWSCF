
## Description

Rackspace Hosting - Base VPC, Network, and NAT gateways. Please be aware that this template will create resources for which you will be charged.
## Diagram



![BaseNetwork Architecture Diagram](https://github.com/rax-brazil/CloudFormations/raw/master/roles/BaseNetwork/files/Network_Ref_Arch_011915-VPC.png "BaseNetwork Architecture Diagram")


#### Metadata

 * **AWS::CloudFormation::Interface**: {u'ParameterGroups': [{u'Parameters': [u'AvailabilityZoneCount', u'PublicSubnetAZ1', u'PublicSubnetAZ2', u'PublicSubnetAZ3', u'PrivateSubnetAZ1', u'PrivateSubnetAZ2', u'PrivateSubnetAZ3'], u'Label': {u'default': u'Network Configuration'}}, {u'Parameters': [u'InstanceTenancy'], u'Label': {u'default': u'EC2 Configuration'}}], u'ParameterLabels': {u'CIDRRange': {u'default': u'What should VPC CIDR Range be?'}}}
 * **Comments**: {u'Comments': u'Generated by Ansible'}
 * **Version**: {u'Version': u'v1.1.0'}

## Parameters

 * **AvailabilityZoneCount** - Number of Availability Zones (3 AZs needs a use case)
  * Default: `2 AZs :: 4 Subnets`
  * Constraint: `Must be either 2 or 3.`
 * **CIDRRange** - The IP address space to be used for this VPC, in CIDR notation
  * Default: `172.18.0.0/16`
  * Constraint: `Must be a valid CIDR range of the form x.x.x.x/x.`
 * **Environment** - Application environment for which this network is being created. e.g. Development/Production
  * Default: `Development`
 * **InstanceTenancy** - VPC default for single tenant (dedicated) vs multi-tenant (default) hypervisor. Overrides instance level tenancy option.
  * Default: `default`
  * Constraint: `Must be either 'default' for multi-tenant hypervisor or 'dedicated' for single tenant hypervisor.`
 * **PrivateSubnetAZ1** - Private IP subnet used for AZ1.  Default "172.18.32.0/21"
  * Default: `172.18.32.0/21`
  * Constraint: `Must be a valid CIDR range of the form x.x.x.x/x.`
 * **PrivateSubnetAZ2** - Private IP subnet used for AZ2.  Default "172.18.40.0/21"
  * Default: `172.18.40.0/21`
  * Constraint: `Must be a valid CIDR range of the form x.x.x.x/x.`
 * **PrivateSubnetAZ3** - (Conditional) Private IP subnet used for AZ3.  Default "172.18.48.0/21"
  * Default: `172.18.48.0/21`
  * Constraint: `Must be a valid CIDR range of the form x.x.x.x/x.`
 * **PublicSubnetAZ1** - Public IP subnet used for AZ1.  Default "172.18.0.0/22"
  * Default: `172.18.0.0/22`
  * Constraint: `Must be a valid CIDR range of the form x.x.x.x/x.`
 * **PublicSubnetAZ2** - Public IP subnet used for AZ2.  Default "172.18.4.0/22"
  * Default: `172.18.4.0/22`
  * Constraint: `Must be a valid CIDR range of the form x.x.x.x/x.`
 * **PublicSubnetAZ3** - (Conditional) Public IP subnet used for AZ3.  Default "172.18.8.0/22"
  * Default: `172.18.8.0/22`
  * Constraint: `Must be a valid CIDR range of the form x.x.x.x/x.`
 * **VPNGateway** - Creates a virtual private gateway. A virtual private gateway is the VPC-side endpoint for your VPN connection.
  * Default: `False`

## Conditions

 * **Create3AZs** - `{u'Fn::Equals': [{u'Ref': u'AvailabilityZoneCount'}, u'3 AZs :: 6 Subnets']}`
 * **CreateVPNGateway** - `{u'Fn::Equals': [{u'Ref': u'VPNGateway'}, u'True']}`

## Mappings


## Resources

 * **EIPNATAZ1** - `AWS::EC2::EIP`
 * **EIPNATAZ2** - `AWS::EC2::EIP`
 * **EIPNATAZ3** - `AWS::EC2::EIP`
 * **IGWBase** - `AWS::EC2::InternetGateway`
 * **NATAZ1** - `AWS::EC2::NatGateway`
 * **NATAZ1Route** - `AWS::EC2::Route`
 * **NATAZ2** - `AWS::EC2::NatGateway`
 * **NATAZ2Route** - `AWS::EC2::Route`
 * **NATAZ3** - `AWS::EC2::NatGateway`
 * **NATAZ3Route** - `AWS::EC2::Route`
 * **PrivateNetAZ1** - `AWS::EC2::Subnet`
 * **PrivateNetAZ2** - `AWS::EC2::Subnet`
 * **PrivateNetAZ3** - `AWS::EC2::Subnet`
 * **PublicNetAZ1** - `AWS::EC2::Subnet`
 * **PublicNetAZ2** - `AWS::EC2::Subnet`
 * **PublicNetAZ3** - `AWS::EC2::Subnet`
 * **RouteAssociationPrivateAZ1Default** - `AWS::EC2::SubnetRouteTableAssociation`
 * **RouteAssociationPrivateAZ2Default** - `AWS::EC2::SubnetRouteTableAssociation`
 * **RouteAssociationPrivateAZ3Default** - `AWS::EC2::SubnetRouteTableAssociation`
 * **RouteAssociationPublicAZ1Default** - `AWS::EC2::SubnetRouteTableAssociation`
 * **RouteAssociationPublicAZ2Default** - `AWS::EC2::SubnetRouteTableAssociation`
 * **RouteAssociationPublicAZ3Default** - `AWS::EC2::SubnetRouteTableAssociation`
 * **RoutePublicDefault** - `AWS::EC2::Route`
 * **RouteTablePrivateAZ1** - `AWS::EC2::RouteTable`
 * **RouteTablePrivateAZ2** - `AWS::EC2::RouteTable`
 * **RouteTablePrivateAZ3** - `AWS::EC2::RouteTable`
 * **RouteTablePublic** - `AWS::EC2::RouteTable`
 * **VGAIGWBase** - `AWS::EC2::VPCGatewayAttachment`
 * **VPCBase** - `AWS::EC2::VPC`
 * **VPNGatewayResource** - `AWS::EC2::VPNGateway`

## Outputs

 * **outputDefaultSG** - `{u'Fn::GetAtt': [u'VPCBase', u'DefaultSecurityGroup']}`
 * **outputElasticIP1** - `{u'Ref': u'EIPNATAZ1'}`
 * **outputElasticIP2** - `{u'Ref': u'EIPNATAZ2'}`
 * **outputElasticIP3** - `{u'Ref': u'EIPNATAZ3'}`
 * **outputEnvironment** - `{u'Ref': u'Environment'}`
 * **outputPrivateSubnets** - `{u'Fn::Join': [u',', [{u'Ref': u'PrivateNetAZ1'}, {u'Ref': u'PrivateNetAZ2'}, {u'Fn::If': [u'Create3AZs', {u'Ref': u'PrivateNetAZ3'}, {u'Ref': u'AWS::NoValue'}]}]]}`
 * **outputPublicSubnets** - `{u'Fn::Join': [u',', [{u'Ref': u'PublicNetAZ1'}, {u'Ref': u'PublicNetAZ2'}, {u'Fn::If': [u'Create3AZs', {u'Ref': u'PublicNetAZ3'}, {u'Ref': u'AWS::NoValue'}]}]]}`
 * **outputRouteTablePrivateAZ1** - `{u'Ref': u'RouteTablePrivateAZ1'}`
 * **outputRouteTablePrivateAZ2** - `{u'Ref': u'RouteTablePrivateAZ2'}`
 * **outputRouteTablePrivateAZ3** - `{u'Ref': u'RouteTablePrivateAZ3'}`
 * **outputRouteTablePublic** - `{u'Ref': u'RouteTablePublic'}`
 * **outputSubnetPrivateAZ1** - `{u'Ref': u'PrivateNetAZ1'}`
 * **outputSubnetPrivateAZ2** - `{u'Ref': u'PrivateNetAZ2'}`
 * **outputSubnetPrivateAZ3** - `{u'Ref': u'PrivateNetAZ3'}`
 * **outputSubnetPublicAZ1** - `{u'Ref': u'PublicNetAZ1'}`
 * **outputSubnetPublicAZ2** - `{u'Ref': u'PublicNetAZ2'}`
 * **outputSubnetPublicAZ3** - `{u'Ref': u'PublicNetAZ3'}`
 * **outputVPCID** - `{u'Ref': u'VPCBase'}`
 * **outputVPNGateway** - `{u'Ref': u'VPNGatewayResource'}`